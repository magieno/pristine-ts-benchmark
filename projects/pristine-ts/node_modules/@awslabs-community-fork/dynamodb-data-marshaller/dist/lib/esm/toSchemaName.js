import { AttributePath } from '@awslabs-community-fork/dynamodb-expressions';
export function toSchemaName(path, schema) {
    if (typeof path === 'string') {
        path = new AttributePath(path);
    }
    const elements = path.elements.map(el => (Object.assign({}, el)));
    let cursor = {
        type: 'Document',
        members: schema
    };
    for (const element of elements) {
        if (element.type === 'AttributeName' &&
            cursor &&
            cursor.type === 'Document') {
            const { name } = element;
            element.name = getSchemaName(name, cursor.members);
            cursor = cursor.members[name];
        }
        else if (element.type === 'ListIndex' &&
            cursor &&
            cursor.type === 'List') {
            cursor = cursor.memberType;
        }
        else {
            break;
        }
    }
    return new AttributePath(elements);
}
export function getSchemaName(propertyName, schema) {
    const fieldSchema = schema[propertyName];
    if (fieldSchema) {
        const { attributeName = propertyName } = fieldSchema;
        return attributeName;
    }
    return propertyName;
}
//# sourceMappingURL=toSchemaName.js.map